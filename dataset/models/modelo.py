import random
import csv
from datetime import datetime, timedelta
from collections import defaultdict

# Categorias e descrições realistas
categorias = {
    "ABS": [
        "Posto Shell Avenida", 
        "Posto BR Central",
        "Posto Ipiranga Norte",
        "Posto EcoFuel KM 37",
        "Posto Fênix Automotivo",
        "europa",
        "pag autopostosao",
        "pay aut post s", 
        "pay auto posto", 
        "pay centro aut",
        "pay centro auto",
        "pay posto amiga",
        "pay posto breme",
        "posto skay", 
        "posto tio zico", 
        "posto tulio rio bonito", 
        "rshop-aito posto", 
        "rshop-alesat auto",
        "rshop-amigao conv",
        "rshop-amigao rest",
        "rshop-aut post s", 
        "rshop-auto posto", 
        "rshop-centro aut", 
        "rshop-centro auto",
        "rshop-europa 10",
        "rshop-pag autopos",
        "rshop-pag*postoam",
        "rshop-posto 10",   
        "rshop-posto abc d",
        "rshop-posto ameri",
        "rshop-posto amiga",
        "rshop-posto amiza",
        "rshop-posto beira",
        "rshop-posto bizun",
        "rshop-posto brasi",
        "rshop-posto breme",
        "rshop-posto cidad",
        "rshop-posto cross",
        "rshop-posto de pe",
        "rshop-posto doura",
        "rshop-posto estad",
        "rshop-posto europ",
        "rshop-posto fenix",
        "rshop-posto garci",
        "rshop-posto genti",
        "rshop-posto golde",
        "rshop-posto gonca",
        "rshop-posto ipira",
        "rshop-posto jagua",
        "rshop-posto jardi",
        "rshop-posto kioma",
        "rshop-posto lava", 
        "rshop-posto lobo", 
        "rshop-posto maior",
        "rshop-posto mega",
        "rshop-posto milen",
        "rshop-posto minas",
        "rshop-posto nacio",
        "rshop-posto namo", 
        "rshop-posto novo", 
        "rshop-posto okini",
        "rshop-posto perpe",
        "rshop-posto petro",
        "rshop-posto phoen",
        "rshop-posto pirac",
        "rshop-posto porta",
        "rshop-posto rapos",
        "rshop-posto rede",
        "rshop-posto rj sa",
        "rshop-posto rodos",
        "rshop-posto santa",
        "rshop-posto sao b",
        "rshop-posto sao j",
        "rshop-posto sao v",
        "rshop-posto teixe",
        "rshop-posto trevo",
        "rshop-posto uniao",
        "rshop-posto vip",  
        "rshop-posto vitor",
        "rshop-posto xavan",
        "rshop-qg posto de",
        "rshop-xodo posto"
    ],
    "AGU" : [
        "bki sabesp", "cxe sabesp", "dae americana", "int /dae american", "int dae american",
        "int sabesp", "pagamento de conta de agua", "Pagamento Conta Gás Naturgy",
        "Débito automático - Conta de Água Sabesp", "Pagamento Boleto Conta de Água Sabesp",
        "Pagamento Conta de Gás Naturgy", "bki elektro", "cpfl cia paulista fo",
        "cpfl paulista", "cxe elektro", "int cpfl paulistA", "int cpfl", "int cpfl paulist",
        "int elektro", "int elet.paulo", "Pagamento Boleto Conta de Luz Enel",
        "Débito Automático Conta Copel Energia", "Débito Automático Conta de Energia Enel"
    ],
    "APL" : [
        "apl aplic aut mais", "aplicação rdb", "cof aplicacao cdb", "compra de criptomoedas",
        "dinheiro guardado com resgate planejado", "rend pago aplic aut mais",
        "res aplic aut mais", "resgate rdb"
    ],
    "ASS": [
        "Netflix Streaming de filmes",
        "Spotify Música por assinatura",
        "Amazon Prime Entregas e vídeos",
        "Clube Wine Vinhos mensais",
        "Tag Livros Clube de leitura",
        "Adobe Creative Cloud",
        "Dropbox Armazenamento em nuvem",
        "NordVPN Segurança online",
        "abril assinat abril",
        "assinatura",
        "amazon br",
        "amazon prime canais",
        "amazonprimebr",
        "bki vivo-sp",
        "cxe claro tv",
        "cxe pre-pago",
        "cxe telefonica",  
        "cxe vivo-sp",
        "da  net servicos", 
        "deb autor abril",
        "deb autor netflix.com",
        "dec pre-pago",
        "editora e dist educaci", 
        "google amazon mobile",
        "google amazon prime v",
        "google duolingo",
        "google ellation",
        "int claro s.a",
        "int /vivo-sp",
        "int claro tv",
        "int embratel-21",
        "int pre-pago",
        "int telefonica", 
        "int tim celular",
        "int timcel-sa",
        "int vivo fixo nac",
        "int vivo-sp",
        "microsoft*microsoft", 
        "on netflix com",
        "pay telecom",
        "pay netfl",
        "pay netflix com",
        "pay netflix ent",
        "ppro microsoft",
        "sisdeb globo.com",
        "sisdeb netflix",
        "sisdeb netflix.com",
        "sisdeb sky+directv",
        "Spotify Premium",
        "Disney+",
        "HBO Max",
        "Apple Music",
        "Prime Video",
        "Show de Música",
        "YouTube Premium",
        "Deezer",
        "Globoplay",
        "Assinatura Netflix",
        "Compra App Store",
        "Pagamento Spotify Premium",
        "Assinatura Amazon Prime Video",
        "Pagamento Netflix Mensal",
        "Assinatura Deezer Mensal",
        "Compra Google Play Store",
        "Assinatura HBO Max",
        "Pagamento Amazon Kindle",
        "Pagamento Spotify Duo",
        "Assinatura Crunchyroll Premium",
        "Assinatura Globoplay",
        "Assinatura Microsoft 365",
        "Assinatura Apple Music",
        "Assinatura Adobe Creative Cloud",
        "Assinatura LinkedIn Premium",
        "Assinatura Twitch Turbo",
        "Assinatura Paramount+",
        "Assinatura Disney+",
        "Assinatura Telecine Play",
        "Assinatura Amazon Prime Video",
        "Assinatura YouTube Premium",
        "Assinatura Globoplay",
        "Compra App Store",
        "Assinatura Deezer",
        "Assinatura HBO Max",
        "Assinatura Canva Pro",
        "Assinatura Netflix",
        "Assinatura Adobe Acrobat Pro",
        "Assinatura Apple One",
        "Assinatura Disney+"
    ],
    "BAR": [        
        "Restaurante Saboroso",
        "Choperia Central",
        "Pizzaria Bella Massa",
        "Café Colonial",
        "Bar do Alemão",
        "Food Truck – Festival",
        "10 pasteis - santa bar", 
        "adega de far-ct",
        "adega de fartura",
        "banca do pastel",
        "bapka sorveteria", 
        "burger king shopping",
        "compra no débito - adelice rosa",
        "compra no débito - coxinha de ouro",
        "compra no débito - dona dos lanches",
        "compra no débito - eliane bolos",
        "compra no débito - l'anelli sorvetes e ac",
        "compra no débito - pag*pasteldare",
        "compra no débito - pizzaria cillos",
        "compra no débito - ponto do espetinho",
        "compra no débito - rest frangoassado caj",
        "compra no débito - restaurante e lanchone",
        "compra no débito - sabor magico",
        "deposito de bebidas ad",
        "eliane bolos", 
        "eliane bolos-ct",
        "expresso piracicaba", 
        "fini", 
        "first dry",
        "gabriela duarte de cam", 
        "gelatt gobbo-ct",
        "hiotosushi",
        "ifd*ifood.com agencia",
        "ifood",
        "italin house-ct rica", 
        "lanches rodoserv ltda", 
        "lanchonete e churrasca",
        "l'anelli sor-ct s e ac",
        "l'anelli sorvetes", 
        "mp refreska-ct",
        "on ifd*ifood co",
        "on ifood", 
        "padaria bom -ct oso", 
        "padaria la suica",
        "pag*adelicer-ct",
        "pag*guaco", 
        "pag*restaurantejunior", 
        "pay -adega de fa",
        "pay -amigao rest",
        "pay -berlinf*uni",
        "pay -bk - filial",
        "pay -brinks plan",
        "pay -burger king",
        "pay -central lan",
        "pay -chocotivoli",
        "pay -churrasc fo",
        "pay -churrascari",
        "pay -filial bk",
        "pay -fini",       
        "pay -gelatt gobb",
        "pay -gran  coffe",
        "pay -ifd*d esfih",
        "pay -ifd*ifood",
        "pay -ifd*massas", 
        "pay -ifood*br",   
        "pay -lanches rod",
        "pay -mc donalds", 
        "pay -montana gri",
        "pay -pastelaria", 
        "pay -pizzaria", 
        "pay -pizzaria pr",
        "pay -rest nicola",
        "pay -restaurante",
        "pay -rodosnack",
        "pay -sorveteria", 
        "pay -sorvetes tr",
        "pay -starbucks",  
        "pizzaria cillos",
        "rest frangoassado cai",
        "ribeiros cafeteria",
        "rodosnack pe-ct en lanc", 
        "rshop padaria la s0107", 
        "rshop-18 lanches", 
        "rshop-ac pizzaria",
        "rshop-aladin esfi",
        "rshop-andre lanch",
        "rshop-apaloosas",
        "rshop-applebees",  
        "rshop-arabe",      
        "rshop-argeu alves",
        "rshop-av bar rest",
        "rshop-bar bilhar", 
        "rshop-bar do heli",
        "rshop-bar do zado",
        "rshop-bar e lanc", 
        "rshop-bar e rest",
        "rshop-bar irmaos", 
        "rshop-bar lanc so",
        "rshop-bar mate am",
        "rshop-bar provide",
        "rshop-barra doce",
        "rshop-beirutao la",
        "rshop-bem doce al",
        "rshop-beto pizzar",
        "rshop-big",        
        "rshop-big bar",    
        "rshop-big bem",    
        "rshop-big jack ha",
        "rshop-big jek bur",
        "rshop-big pastel", 
        "rshop-big sabor",  
        "rshop-big x pican",
        "rshop-bistecao",   
        "rshop-bistekao pa",
        "rshop-bk - filial",
        "rshop-bk barueri", 
        "rshop-bk brasil",  
        "rshop-bk tivoli",  
        "rshop-bobs",       
        "rshop-burger comp",
        "rshop-burger king",
        "rshop-cacambas ca",
        "rshop-cacau show", 
        "rshop-cafe da pra",
        "rshop-cafe del pl",
        "rshop-cafe do pon",
        "rshop-cafe e bar",
        "rshop-cafe estaca",
        "rshop-cafe shopp", 
        "rshop-cafeteria",
        "rshop-carol coxin",
        "rshop-casa bauduc",
        "rshop-cervejaria",
        "rshop-choperia ba",
        "rshop-choperia co",
        "rshop-chopperia",
        "rshop-chuchurros", 
        "rshop-churr  camp",
        "rshop-churr lanch",
        "rshop-churr recan",
        "rshop-churra  for",
        "rshop-churrascari",
        "rshop-coffee hous",
        "rshop-doce mania", 
        "rshop-doctor chur",
        "rshop-eliane bolo",
        "rshop-frutti coco",
        "rshop-gaia grill",
        "rshop-grazi paste",
        "rshop-guitar burg",
        "rshop-habibs",     
        "rshop-kopenhagen", 
        "rshop-lanches rod",
        "rshop-lanchonete", 
        "rshop-mafia pizza",
        "rshop-mb doces",   
        "rshop-mc donald",
        "rshop-mc donalds",
        "rshop-mc donalds",
        "rshop-mcdonalds a",
        "rshop-padaria fra",
        "rshop-padaria la", 
        "rshop-padovani ag",
        "rshop-pag adelice",
        "rshop-pag pasteld",
        "rshop-pag*burgerh",
        "rshop-pag*carolco",
        "rshop-pag*csalgad",
        "rshop-pag*docesab",
        "rshop-pag*pizzari",
        "rshop-palazzio re",
        "rshop-pastel & ci",
        "rshop-pastel mani",
        "rshop-pastelaria", 
        "rshop-ph sorvetes",
        "rshop-pizza cillo",
        "rshop-pizza compa",
        "rshop-pizza hut32",
        "rshop-pizzaria ca",
        "rshop-pizzaria ci",
        "rshop-pizzaria mi",
        "rshop-pizzaria",
        "rshop-pizzaria pa",
        "rshop-pizzaria pr",
        "rshop-pizzaria ro",
        "rshop-pizzaria si",
        "rshop-pollo pizza",
        "rshop-pub",        
        "rshop-rei do past",
        "rshop-restaurante",
        "rshop-rodosnack",
        "rshop-rucula pica",
        "rshop-sabor expre",
        "rshop-sabor magic",
        "rshop-sid s pizza",
        "rshop-subway",
        "rshop-subway botu",
        "rshop-subway hava",
        "rshop-subway ouri",
        "rshop-subway shop",
        "rshop-telepizza",
        "rshop-varile bar",
        "rshop-viena expre",
        "rshop-yogo fresh",
        "Pedido Uber Eats - Pizza Rápida",
        "Pedido feito via iFood - Sushibar",
        "Pedido Rappi - Burguer Mania",
        "Compra Delivery Express Lanches",
        "Compra Cafeteria Starbucks",
        "Compra em Sorveteria Local",
        "Pedido iFood - Marmitex da Vó",
        "Compra em Loja de Conveniência",
        "Pedido Uber Eats - Hamburgueria",
        "Compra Kopenhagen Doces",
        "Compra Cacau Show Chocolates",
        "Compra Pizzaria Bella Massa",
        "Compra Lanchonete Central",
        "Compra Sorveteria Gelato Art",
        "Compra Restaurante Girassol",
        "Compra Restaurante Veggie Vida",
        "Compra iFood - Esfiha da Praça",
        "Pedido Rappi - Lanches do Tio Zé",
        "Pedido iFood - Lanches Express",
        "Compra em Loja de Conveniência",
        "Compra Café da Praça",
        "Compra Cacau Show Chocolates",
        "Pedido iFood - Pizzaria Bella Roma",
        "Pedido Uber Eats - Sushi Mix",
        "Compra Empório Vegano",
        "Compra Kopenhagen Doces",
        "Compra Sorveteria Delícias Geladas",
        "Restaurante Bob's",
        "Restaurante Madero",
        "Compra Restaurante Churrasquim",
        "Restaurante Fogo de Chão",
        "Restaurante China in Box",
        "Restaurante Giraffas",
        "Restaurante Outback",
        "Restaurante Spoleto",
        "Restaurante Habib's",
        "Restaurante Applebee's",
    ],
    "CAS": [
        "Faxina pesada – Limpeza geral",
        "Pintura de parede externa",
        "Encanador – Vazamento",
        "Montagem de móveis",
        "Dedetização residencial",
        "Instalação de ventilador de teto",
        "Limpeza de caixa d’água",
        "Chaveiro residencial",
        "bandini lar construcao", 
        "compra no débito - limpa limpou", 
        "construdecor",  
        "europa gas", 
        "pay bandini lar", 
        "pay bandini", 
        "pay construdeva", 
        "pay construeva", 
        "pay sodimac", 
        "rshop-bandini", 
        "rshop-cacique mat",
        "Compra Tok&Stok",
        "Compra Loja de Decoração Ateliê Home",
        "Compra Material de Construção",
        "Compra Casa & Reforma Ferragens"
    ],
    "CRD" : [
        "cred investim",
        "crediario autom",
        "crediario itau",
        "credito cartao",
        "crédito",
        "crédito de parcelamento",
        "crédito de rotativo",
        "Fatura Nubank – Pagamento mensal",
        "Cartão Visa – Compra parcelada",
        "Pagamento rotativo – MasterCard",
        "Fatura Banco Inter"
    ],
    "EDU": [
        "Curso online – Alura",
        "Mensalidade escola infantil",
        "Curso técnico – Senai",
        "Curso de redação – Pré-vestibular",
        "Plataforma de estudos – Descomplica",
        "Livraria Cultura",
        "Cursos Online",
        "Livros Técnicos",
        "Pós-Graduação",
        "Material Didático",
        "Curso de Idiomas",
        "Livros Universitários"
    ],
    "IMP" : [
        "cxe ipva-sp frw-6462",
        "int das",
        "int dpvat-sp fuy-6701",
        "int ipva-sp fbt-8481",
        "int ipva-sp frw-6462",
        "int ipva-sp fuy-6701",
        "int ipva-spfbt8481",
        "int ipva-spfuy6701",
        "iof",
        "iof de rotativo",
        "inss",
        "irrf",
        "pis",
        "cofins",
        "imposto de renda",
        "dpvat",
        "ipva",
        "Imposto de renda – IRPF",
        "Taxa de lixo – Prefeitura",
        "Contribuição sindical anual",
        "IPTU – Imóvel urbano"
    ],
    "JUR" : [
        "cxe das",
        "cxe multa sp", 
        "int multa sp", 
        "itau sob medida",
        "juros atraso lim conta",
        "juros de rotativo",
        "juros excesso lim conta",
        "juros limite da conta",
        "lis/juros",
        "multa atraso lim conta",
        "multa de transito",
        "Juros cartão de crédito"
    ],
    "LAZ" : [
        "hotel imperial", 
        "pay hotel imper",
        "pousada bela-ct ta",
        "pousada pe na terra",
        "rshop-beto carrer",
        "rshop-hotel atlan",
        "rshop-hotel barra",
        "rshop-hotel formu",
        "rshop-hotel imper",
        "rshop-hotel monre",
        "rshop-hotel nacio",
        "rshop-hotel piva ",
        "rshop-hotel silve",
        "rshop-hotel unive",
        "rshop-new bowling",
        "rshop-october fes",
        "rshop-roari hotel",
        "Reserva de hotel – Férias",
        "Compra de ingresso – Cinema",
        "Passagem aérea – Viagem",
        "Excursão para parque aquático",
        "Airbnb – Final de semana",
        "Museu de Arte Moderna – Ingresso",
        "Cinema Cinemark",
        "Show Teatro",
        "Parque de Diversões",
        "Teatro Municipal",
        "Cinépolis",
        "Show de Música",
        "Parque Aquático",
        "Zoo Safari",
        "Compra Cinemark Ingresso",
        "Compra Loteria MegaSorte",
        "Compra Cervejaria Artesanal HopLand",
        "Compra Loja Geek Hero World",
        "Compra Cinemark - Ingresso"

    ],
    "LOJ" : [
        "1a99",
        "a instrumental instrum",
        "aliexpress",
        "americana informat",
        "aparecida rosilene mar",
        "beta lingerie",
        "christini ar-ct",
        "coldibelli e hoffmann",
        "coldibelli e-ct fm",
        "coldibelli e-ct fmann",
        "compra no débito - planeta agua",
        "compra no débito - brinks planet",
        "compra no débito - construdecor",
        "compra no débito - cristal produtos natur",
        "compra no débito - dang peng comercio",
        "compra no débito - estacao cultural",
        "compra no débito - geo cosmeticos",
        "compra no débito - loja 199 da vitoria",
        "compra no débito - magazine americana",
        "compra no débito - mp *marli",
        "compra no débito - opsom",
        "compra no débito - pag*andersonroberto",
        "compra no débito - pag*arjoiasecriativas",
        "compra no débito - pag*buffetfioridi",
        "compra no débito - pag*eletronica",
        "compra no débito - pag*osmarvieirado",
        "compra no débito - panda boutique c de bi",
        "compra no débito - pereira silvestre come",
        "compra no débito - pg *ton max 15 ikeda",
        "compra no débito - porfirio neres santan",
        "compra no débito - riso comercio de produ",
        "compra no débito - s s santiago",
        "compra no débito - sagrada face de americ",
        "compra no débito - shopping da utilidade",
        "compra no débito - siguivila comercio de",
        "compra no débito - souza conveniencia adm",
        "compra no débito - thalita gutierres cald",
        "compra no débito - wanda maria dos santo",
        "compra no débito- gabioneta comercio",
        "cristal podu-ct natura",
        "daiso brasil",
        "danny cosmeticos ",
        "dl *shein",
        "dl *sheincom",
        "foto eletron",
        "foto princip-ct",
        "geo cosmetic-ct",
        "geo cosmeticos",
        "havan sta ba-ct",
        "havelinos -ct",
        "int shopline ebanx",
        "int shopline pgto digita",
        "jackson dias padilho",
        "jakson dias padilh",
        "joao carlos r bueno dr",
        "jovanelli e -ct tti",
        "karina autuo-ct meric",
        "karina autuori americ", 
        "loja veste 1-ct",
        "lucia helena-ct souza",
        "luciana aparecida alv",
        "magazine ame-ct na ltd",
        "maion conven-ct ias",
        "maravilhas do lar",
        "marli",
        "mercadolivre*2produto",
        "mercadolivre*50822252", 
        "mercadolivre*fortesup",
        "mercadolivre*lardasfita",
        "mercadolivre*mercadol",
        "mercadolivre*motorsma",
        "mercadolivre*yaz",
        "miniso dom pedro",
        "moreira e lenhare ltd",
        "mp *argeuhot-ct",
        "mp *gatoajat-ct",
        "mp *melimais",
        "mp*feira",
        "nilzete a. d-ct an",
        "on ebanx spotif2701",
        "pag*40381812katia",
        "pag*bpmgsaod-ct gos", 
        "pag*camicado",
        "pag*denisezerbeto",
        "pag*elisange-ct rrea",
        "pag*estrela -ct",
        "pag*fantasiatelegas", 
        "pag*mahogany ",
        "pag*mariaapa-ct da",
        "pag*mayconfreitas",
        "pag*solangeaparecida",
        "pag*youplayc-ct",
        "panda boutique c de bi",
        "pay  -a instrumen",
        "pay  -acucena per",
        "pay  -anaguga bij",
        "pay  -cristiano r",
        "pay  -dang peng c",
        "pay  -daniel gard",
        "pay  -fator",
        "pay  -flavio luka",
        "pay  -floricultur",
        "pay  -foto eletro",
        "pay  -galeria do",
        "pay  -go inn jagu",
        "pay  -hopbeer",     
        "pay  -lojas ameri",
        "pay  -luciana apa",
        "pay  -maddalena m",
        "pay  -magic games",
        "pay  -marga",
        "pay  -margarete",
        "pay  -marlene rod",
        "pay  -moreira",
        "pay  -mp *oceanus",
        "pay  -multi v*eri",
        "pay  -nicaro come",
        "pay  -premium cel",
        "pay  -shop limeir",
        "pay  -shoping",
        "pay  -shopping pi",
        "pay  -shopping",
        "pay  -star games", 
        "pay  -studio game",
        "pay  -tivoli",
        "pay  -zanini",   
        "piticas tivoli shoppin", 
        "porfirio ner-ct antan", 
        "quiosque do -ct",
        "quiosque do -ct irinho", 
        "rshop daiso 20 2306",
        "rshop kenia parrei0107",
        "rshop miniso dom p3006",
        "rshop pg ton max 0306",
        "rshop-184 piracic",
        "rshop-1a99",            
        "rshop-293 santa",
        "rshop-355 shoppin",
        "rshop-a c jorio",
        "rshop-a da silva", 
        "rshop-a e c jorio",
        "rshop-a instrumen",
        "rshop-a paulistan",
        "rshop-a precioso", 
        "rshop-a servicos", 
        "rshop-abrahao rod",
        "rshop-ac alphavil",
        "rshop-ac american",
        "rshop-adilson dos",
        "rshop-adilson rab",
        "rshop-adiqplu*mai",
        "rshop-admilson be",
        "rshop-adriana",
        "rshop-aki tem",     
        "rshop-aki tem ame",
        "rshop-amora froze",
        "rshop-ana paula",
        "rshop-analu colch",
        "rshop-anderson am",
        "rshop-art biju",   
        "rshop-art real",   
        "rshop-arte bela",  
        "rshop-arte e imag",
        "rshop-arte em acu",
        "rshop-artista da", 
        "rshop-autozone br",
        "rshop-barbearia",
        "rshop-bel livrari",
        "rshop-bela moca", 
        "rshop-bela vista", 
        "rshop-bella bijou",
        "rshop-bella cosme",
        "rshop-bella mar",
        "rshop-bella minei",
        "rshop-belle bras",
        "rshop-bem barato", 
        "rshop-beta linger",
        "rshop-bijucom",    
        "rshop-bites e byt",
        "rshop-bizunguinha",
        "rshop-brasilar mo",
        "rshop-casas perna",
        "rshop-centauro",
        "rshop-coldibelli", 
        "rshop-construdeva",
        "rshop-cybelar ame",
        "rshop-cybelar far",
        "rshop-cybelar pir",
        "rshop-debora rodr",
        "rshop-dia loja 29",
        "rshop-dms servico",
        "rshop-doca moda i",
        "rshop-ebanx spoti",
        "rshop-engracia re",
        "rshop-foto princi",
        "rshop-geo cosmeti",
        "rshop-guarafarma",
        "rshop-havan lojas",
        "rshop-havan sta b",
        "rshop-havanna pir",
        "rshop-informatica",
        "rshop-internacion",
        "rshop-joanin loja",
        "rshop-kenia parre",
        "rshop-l anelli so",
        "rshop-loja 1,99",
        "rshop-loja 199",
        "rshop-loja 576", 
        "rshop-loja criati",
        "rshop-loja da sog",
        "rshop-loja eliane",
        "rshop-loja lupo",  
        "rshop-loja rosy",  
        "rshop-loja sao mi",
        "rshop-loja veste",
        "rshop-lojao do ba",
        "rshop-lojas ameri",
        "rshop-lojas cem",  
        "rshop-lojas elian",
        "rshop-lojas nippo",
        "rshop-lojas renne",
        "rshop-lojas sao",
        "rshop-lojas uniao",
        "rshop-lojas vale", 
        "rshop-lojas zanin",
        "rshop-m2 informat",
        "rshop-magazine am",
        "rshop-magazine to",
        "rshop-makro loja", 
        "rshop-marisa loja",
        "rshop-nota mil ad",
        "rshop-pag*lojahip",
        "rshop-tks loja vi",
        "rshop-ultracenter",
        "rshop-zanini",     
        "rshop-zanini a lj",
        "rshop-zanini a lo",
        "rshop-zanini kids",
        "rshop-zanini matr",
        "shopee *avenuestor",
        "shopee *avenuestore", 
        "shopee *luaaz",
        "shopee *shpstecnol",
        "shopping da -ct idade",
        "shopping piracicaba", 
        "shpp brasil servicos",
        "siguivila co-ct io de",
        "super pop ca-ct os",
        "super pop calcados",
        "tbi 0766.11118-1loja",
        "v b ribeiro -ct eza",
        "v f lima",
        "w demez conv-ct ncia",
        "wanda maria dos santo", 
        "zul 10 cartoes rhh2k",
        "Compra Mercado Livre",
        "Compra Shopee Marketplace",
        "Compra Submarino.com",
        "Compra via Mercado Pago",
        "Compra Amazon Books",
        "Compra Submarino.com",
        "Compra Lojas Americanas Online"
    ],
    "MAN": [
        "Troca de óleo", "Revisão completa – Mecânica do João", "Troca de pastilhas de freio",
        "Reparo no ar-condicionado", "Alinhamento e balanceamento", "Lavagem premium",
        "alga mecanica e eletr", "compra no débito - panaro estetica automo", "four mit",
        "mecanica possobom", "pay paschoal", "pay evotek", "portal de poa auto pos", 
        "romaninho serv automo", "rshop-ancar centr", "rshop-d paschoal", 
        "rshop-dpaschoal", "rshop-mao na roda", "autozone brasil com au"
    ],
    "MER": [
        "Supermercado Extra",
        "Feira do Produtor",
        "Açougue Central",
        "Padaria Pão Quente",
        "Empório Natural",
        "Atacadão",
        "Carrefour Bairro",
        "casa de carnes boi gor", 
        "agro pet sho-ct ropa",
        "agropet mine-ct ltda",
        "assai atacad-ct",
        "assai atacadista",
        "atac e a serv esperanc", 
        "atacadao 166-ct",
        "atacadao 333-ct",
        "atacadao 948-ct",
        "b pmg sao domingos", 
        "casa de carn-ct i gord", 
        "casa de carn-ct oi gor",
        "casa de carne boi gord",
        "casa de carne boi gord", 
        "casa de carnes boi gor",
        "casa de carnes e resta",
        "cobasi americana",
        "cobasi sb oe-ct tivoli",
        "cobasi sb oeste tivoli",
        "compra no débito - mercado sertanejo",
        "compra no débito - pg *ton padariA",
        "compra no débito - supermercado thais",
        "compra no débito - agropet mineiro",
        "compra no débito - assai atacadista",
        "compra no débito - atac e a serv esperanc",
        "compra no débito - atacadao 625",
        "compra no débito - auto posto luz do sol",
        "compra no débito - chef",
        "compra no débito - cobasi americana",
        "compra no débito - comercio de generos",
        "compra no débito - rede oba - americana",
        "compra no débito - sup sao vicente",
        "compra no débito - super pop calcados",
        "compra no débito - supermercado crema",
        "compra no débito - supermercado italia",
        "compra no débito - supermercado pague men",
        "compra no débito - supermercado sao franc",
        "compra no débito - tenda atacado",
        "delicias da padoka",
        "emporio flor-ct",
        "higa atacado",
        "higa atacado-ct",
        "higilimp", 
        "mercado sertanejo",
        "mercado sert-ct",
        "mp *higilimp-ct",
        "nobres beef -ct",
        "pag*nobresbeef",
        "pay assai ataca",
        "pay atac e a se",
        "pay atacadao 16",
        "pay atacadao 33",
        "pay carrefour",
        "pay ifd*cobasi",
        "pay ifd*mercado",
        "pay ifd*superme",
        "pay merca",
        "pay mercadinho", 
        "pay mercado nos",
        "pay nicolau max",
        "pay savegnago s",
        "pay sup sao vic",
        "pay supermercad",
        "pay thais super",
        "planeta agua",
        "rshop-acougue san",
        "rshop-agro pet eu",
        "rshop-agro pet sh",
        "rshop-agro pet-sh",
        "rshop-agro shop",
        "rshop-agro tavare",
        "rshop-agropecuari",
        "rshop-agropet min",
        "rshop-agropet pad",
        "rshop-agropetfar", 
        "rshop-amigo pet",  
        "rshop-assai ataca",
        "rshop-atac",
        "rshop-atacadao",
        "rshop-carrefour",  
        "rshop-casa carnes",
        "rshop-casa de car",
        "rshop-chef",       
        "rshop-cjc superme",
        "rshop-cobasi lime",
        "rshop-cobasi sb",
        "rshop-econ superm",
        "rshop-france supe",
        "rshop-higa atacad",
        "rshop-limpa limpo",
        "rshop-mercad vila",
        "rshop-mercadao da",
        "rshop-mercadinho",
        "rshop-mercado ana",
        "rshop-mercado pag",
        "rshop-mercado ser",
        "rshop-mercadopago",
        "rshop-minimercado",
        "rshop-mp *mercado",
        "rshop-natacadus",
        "rshop-nicolau max",
        "rshop-nobre s bee",
        "rshop-oxxo comend",
        "rshop-padaria ami",
        "rshop-padaria bar",
        "rshop-padaria but",
        "rshop-padaria flo",
        "rshop-padaria fra",
        "rshop-padaria gua",
        "rshop-padaria la",
        "rshop-padaria san",
        "rshop-pag*padaria",
        "rshop-pag*sacolao",
        "rshop-panificador",
        "rshop-pao de acuc",
        "rshop-sacolao che",
        "rshop-sacolao do",
        "rshop-sacolao vil",
        "rshop-seta atacad",
        "rshop-spani  atac",
        "rshop-sup sao fra",
        "rshop-sup sao vic",
        "rshop-super merca",
        "rshop-super pague",
        "rshop-super sao",
        "rshop-superm pao", 
        "rshop-supermer tu",
        "rshop-supermerc",
        "rshop-supermercad",
        "rshop-tenda ataca",
        "rshop-tenda",
        "rshop-thais super",
        "rshop-verdan 1 99",
        "sacolao cheiro verde",
        "sk supermercados", 
        "sp piracicaba super",
        "sup sao fran-ct",
        "sup sao vicente", 
        "super rodrig-ct taguai",
        "supermercado crema",
        "supermercado italia",
        "supermercado pague men",
        "supermercado sao franc",
        "supermercado thais",
        "supermercado-ct franc", 
        "supermercado-ct",
        "tenda atacado",
        "Compra Feira da Colina",
        "Compra Mini Mercado Flor do Dia",
        "Compra Feira Central Noturna",
        "Compra Mini Mercado Sabor da Terra",
        "Compra Empório Natural Vida",
        "Compra Feira de Produtos Caseiros",
        "Compra Açougue Carnes Nobres",
        "Compra Feira da Praça",
        "Compra Feira Livre Santo Antônio",
        "Compra Feira Livre Bairro",
        "Compra Açougue Bom Corte",
        "Compra Feira Orgânica Sustentável",
        "Compra Feira de Produtos Orgânicos",
        "Compra Feira Noturna Central",
        "Compra Hortifrúti Primavera",
        "Compra Hortifruti Local",
        "Compra Empório Gourmet Central",
        "Compra Panificadora Trigo Dourado",
        "Compra Supermercado Extra",
        "Compra Supermercado Econômico",
        "Compra Supermercado Carrefour",
        "Supermercado Extra",
        "Supermercado Pão de Açúcar",
        "Supermercado Walmart",
        "Supermercado Sonda",
        "Supermercado BH",
        "Supermercado Dia",
        "Supermercado Prezunic",
        "Supermercado Guanabara",
        "Compra Supermercado Carrefour",
        "Compra Mercado Central",
        "Compra Açougue Boi de Ouro",
        "Compra Mercadinho do Bairro",
        "Compra Mercado Dia",
        "Compra em Açougue Santa Carne",
        "Compra Padaria Pão Quentinho"
    ],
    "PED" : [
        "deb autor sem parar", "pay-estacioname", "rshop-estacioname", "sisdeb sem parar",
        "estacionamento", "pedagio", "estacionamento"
    ],
    "SAL": [
        "Salário – Empresa X", "Pagamento CLT – Mês corrente", "Pro labore – PJ",
        "Rendimento freelancer", "Folha de pagamento – Departamento pessoal"
    ],
    "SAU": [
        "Plano de saúde – Mensalidade", "Consulta médica – Clínica popular", "Tratamento odontológico",
        "Exame de sangue – Laboratório XYZ", "Psicoterapia – Sessão semanal", "dentelie", 
        "rshop-dentelie", "todoriso - americ", "dentista","compra no débito - drogaria tododia",
        "drogaria tod-ct", "drogaria tododia", "drogaria tododia", "farlimp -ct", "farma centro fartura",
        "farmacia pronto farma", "granado phar-ct as", "nista vaz drogaria", "pag*farmaciadopovo",
        "pay drog carref", "pay drogaria nu", "pay drogaria to", "pay farlimp", "rshop-2054raia",   
        "rshop-2245drogasi", "rshop-2331raia", "rshop-agafarma ga", "rshop-bio farma",  
        "rshop-cajuru farm", "rshop-drog carref", "rshop-drog exp pi", "rshop-drog sao mi",
        "rshop-drog sao pa", "rshop-droga ex", "rshop-droga pires", "rshop-droga raia", 
        "rshop-droga reims", "rshop-drogafar", "rshop-drogal amer", "rshop-drogal artu",
        "rshop-drogal farm", "rshop-drogao supe", "rshop-drogareims", "rshop-drogaria be",
        "rshop-drogaria fa", "rshop-drogaria gu", 
        "rshop-drogaria",
        "rshop-drogaria no",
        "rshop-drogaria ns",
        "rshop-drogaria po",
        "rshop-drogaria sa",
        "rshop-drogaria to",
        "rshop-drogaria tu",
        "rshop-drogaria ua",
        "rshop-drogaria vi",
        "rshop-drogasil 14",
        "rshop-drogasil 56",
        "rshop-drogasmil",  
        "rshop-farlimp",       
        "rshop-farm homeop",
        "rshop-farma centr",
        "rshop-farma lobo", 
        "rshop-farma mille",
        "rshop-farma nossa",
        "rshop-farma ponte",
        "rshop-farmacia ar",
        "rshop-farmacia br",
        "rshop-farmacia ga",
        "rshop-farmacia pr",
        "rshop-farmacia sa",
        "rshop-farmacia un",
        "rshop-farmaciadop",
        "rshop-farmacias",
        "rshop-farmais bra",
        "rshop-farmalider",
        "rshop-farmax garo",
        "rshop-farmax",
        "rshop-guarafarma", 
        "rshop-nova farma", 
        "rshop-pag farmaci",
        "rshop-pag*drogal", 
        "rshop-pag*farmaci",
        "rshop-prontofarma",
        "rshop-raia drogas",
        "Compra Farmácia Drogasil",
        "Compra Drogaria São Paulo",
        "Pagamento Academia Corpo & Ação",
        "Compra Drogaria Pacheco",
        "Pagamento Consulta Médica",
        "Pagamento Plano de Saúde SulAmérica",
        "Compra Farmácia Pague Menos",
        "Compra em Loja de Suplementos FitnessLab",
        "Compra Drogaria Popular Saúde Já",
        "Compra Drogaria Saúde & Vida",
        "Compra Farmácia Bom Preço",
        "Débito Boleto Plano de Saúde Amil",
        "Compra Drogaria Bem Estar",
        "Pagamento Plano Odontológico DentalPro",
        "Compra Farmácia Vida Plena",
        "Compra Farmácia Drogasil",
        "Mensalidade Academia",
        "Farmácia Droga Raia",
        "Consulta Médica",
        "Farmácia Pacheco",
        "Plano de Saúde",
        "Farmácia São Paulo",
        "Academia Smart Fit",
        "Farmácia Drogaria SP",
        "Exame Laboratorial",
        "Farmácia Nissei",
        "Fisioterapia",
        "Farmácia Drogaria Brasil",
        "Plano Odontológico",
        "Farmácia PagMenos",
        "Consulta Psicólogo",
        "Farmácia Drogaria Araujo",
        "Academia Bio Ritmo",
        "Farmácia Drogaria São Bento"
    ],
    "SEG" : [
        "itau seg", "itau seguros", "pagto itau seguros", "seg multiprotecao", "seguro api",           
        "sisdeb liberty seg", "seguro residencial", "seguro saude", "seguro viagem"
    ],
    "TAR": [
        "Tarifa bancária – DOC", "Manutenção de conta corrente", "TED – Transferência", "Saque 24h – Tarifa", "Anuidade cartão Visa",
        "anuidade diferenciada", "encargos (financiamento + moratório)", "encargos conta corrente", "encargos de atraso", "tar doc eletronico",
        "tar doc internet", "tar doc/ted agendado", "tar doc/ted internet", "tar folha cheque", "tar maxiconta mens", "tar pacote itau",
        "tar saque pessoal", "tar saque terminal", "tar sustacao/revogacao", "tar talao domicilio", "tar ted internet" 
    ],
    "PET": [
        "Consulta veterinária – PetVita", "Ração premium – Cães grandes", "Vacinação – Clínica Pet&Vida", "Banho e tosa – PetShop Alegria",
        "Acessórios – Pet Center", "Compra Petshop Amigo Fiel", "Compra Petz - Pet Shop", "Compra Loja Mundo Pet"
    ],
    "TRP" : [
        "rshop-manoel rodr", "uber pending", "uber one help.uber.com", "uber uber *trip",
        "uber trip"
    ]
}

pesos_categorias = {
    "ABS": 15,   # Abastecimento - frequente
    "AGU": 10,
    "APL": 2,
    "ASS": 8,    # Assinaturas - comum
    "BAR": 12,   # Bares/Restaurantes - muito frequente
    "CAS": 3,    # Casa/Reforma - menos frequente
    "CRD": 8,    # Crédito - comum
    "EDU": 2,    # Educação - menos frequente
    "IMP": 4,    # Impostos - sazonal
    "JUR": 5,    # Juros - comum
    "LAZ": 6,    # Lazer - comum
    "LOJ": 20,   # Lojas - frequente
    "MAN": 3,    # Manutenção - menos frequente
    "MER": 20,   # Mercado - muito frequente
    "PED": 10,   # Pedágio - comum
    "SAL": 1,    # Salário (geralmente só 1 por mês)
    "SAU": 10,   # Saúde - comum
    "SEG": 3,    # Seguros - menos frequente
    "TAR": 7,    # Tarifas - frequente
    "PET": 5,    # Pets - comum
    "TRP": 8     # Transporte - frequente
}

def gerar_data_aleatoria():
    inicio = datetime(2020, 1, 1)
    fim = datetime(2025, 6, 1)
    return inicio + timedelta(days=random.randint(0, (fim - inicio).days))

def gerar_valor(categoria):
    faixa = {
        "ABS": (50, 1000),
        "AGU": (50, 500),
        "APL": (1, 1000),
        "ASS": (10, 300),
        "BAR": (30, 2000),
        "CAS": (150, 4200),
        "CRD": (150, 15000),
        "EDU": (100, 3000),
        "IMP": (20, 500),
        "JUR": (1, 1000),
        "LAZ": (50, 20000),
        "LOJ": (50, 2000),
        "MAN": (100, 5000),
        "MER": (80, 2000),
        "PED": (30, 1000),
        "PET": (30, 1000),
        "SAL": (1500, 10000),
        "SAU": (80, 1500),
        "SEG": (200, 3000),
        "TAR": (5, 100),
        "TRP": (5, 60)
    }
    minimo, maximo = faixa.get(categoria, (20, 200))
    return round(random.uniform(minimo, maximo), 2)

def gerar_transacoes_completas():
    # Primeiro: garantir que cada descrição apareça pelo menos uma vez
    transacoes_obrigatorias = []
    descricoes_utilizadas = defaultdict(set)
    
    for categoria, descricoes in categorias.items():
        for descricao in descricoes:
            data = gerar_data_aleatoria().strftime("%Y-%m-%d")
            valor = gerar_valor(categoria)
            transacoes_obrigatorias.append([data, descricao, categoria, valor])
            descricoes_utilizadas[categoria].add(descricao)
    
    # Segundo: gerar transações adicionais com distribuição ponderada
    transacoes_adicionais = []
    total_transacoes = 2000
    transacoes_restantes = total_transacoes - len(transacoes_obrigatorias)
    
    # Criar lista de categorias baseada nos pesos para seleção ponderada
    categorias_pesadas = []
    for categoria, peso in pesos_categorias.items():
        categorias_pesadas.extend([categoria] * peso)
    
    for _ in range(transacoes_restantes):
        categoria = random.choice(categorias_pesadas)
        
        # Escolher entre descrições não utilizadas ou aleatórias
        descricoes_nao_utilizadas = list(set(categorias[categoria]) - descricoes_utilizadas[categoria])
        
        if descricoes_nao_utilizadas and random.random() < 0.3:  # 30% de chance de pegar uma não utilizada
            descricao = random.choice(descricoes_nao_utilizadas)
            descricoes_utilizadas[categoria].add(descricao)
        else:
            descricao = random.choice(categorias[categoria])
        
        data = gerar_data_aleatoria().strftime("%Y-%m-%d")
        valor = gerar_valor(categoria)
        transacoes_adicionais.append([data, descricao, categoria, valor])
    
    # Combinar e embaralhar todas as transações
    todas_transacoes = transacoes_obrigatorias + transacoes_adicionais
    random.shuffle(todas_transacoes)
    
    return todas_transacoes

# Gerar e salvar o CSV
with open("transacoes_completas.csv", mode="w", newline="", encoding="utf-8") as arquivo: #utf-8
    writer = csv.writer(arquivo, delimiter=";")
    writer.writerow(["data", "descricao", "categoria", "Valor"])
    
    for transacao in gerar_transacoes_completas():
        writer.writerow(transacao)
        
# Verificar cobertura de descrições
with open("transacoes_completas.csv", mode="r", encoding="utf-8") as arquivo:
    reader = csv.reader(arquivo, delimiter=";")
    next(reader)  # Pular cabeçalho
    transacoes_geradas = list(reader)

descricoes_geradas = defaultdict(set)
for _, descricao, categoria, _ in transacoes_geradas:
    descricoes_geradas[categoria].add(descricao)

print("Descrições não geradas por categoria:")
for categoria in categorias:
    faltantes = set(categorias[categoria]) - descricoes_geradas.get(categoria, set())
    if faltantes:
        print(f"{categoria}: {len(faltantes)} faltantes")
    else:
        print(f"{categoria}: TODAS descrições geradas")